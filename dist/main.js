!function(s){var e={};function t(i){if(e[i])return e[i].exports;var h=e[i]={i:i,l:!1,exports:{}};return s[i].call(h.exports,h,h.exports,t),h.l=!0,h.exports}t.m=s,t.c=e,t.d=function(s,e,i){t.o(s,e)||Object.defineProperty(s,e,{enumerable:!0,get:i})},t.r=function(s){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},t.t=function(s,e){if(1&e&&(s=t(s)),8&e)return s;if(4&e&&"object"==typeof s&&s&&s.__esModule)return s;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:s}),2&e&&"string"!=typeof s)for(var h in s)t.d(i,h,function(e){return s[e]}.bind(null,h));return i},t.n=function(s){var e=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(e,"a",e),e},t.o=function(s,e){return Object.prototype.hasOwnProperty.call(s,e)},t.p="",t(t.s=2)}([function(s,e){const t={collide(s,e){const t=s.physics.width?s.physics.width:s.sprite.width,i=e.physics.width?e.physics.width:e.sprite.width,h=s.physics.height?s.physics.height:s.sprite.height,o=e.physics.height?e.physics.height:e.sprite.height;return s.physics.x<e.physics.x+i&&s.physics.x+t>e.physics.x&&s.physics.y<e.physics.y+o&&s.physics.y+h>e.physics.y},collide_with_scale(s,e){const t=s.physics.width?s.physics.width:s.sprite.width*s.sprite.width_scale,i=e.physics.width?e.physics.width:e.sprite.width*e.sprite.width_scale,h=s.physics.height?s.physics.height:s.sprite.height*s.sprite.height_scale,o=e.physics.height?e.physics.height:e.sprite.height*e.sprite.height_scale;return s.physics.x<e.physics.x+i&&s.physics.x+t>e.physics.x&&s.physics.y<e.physics.y+o&&s.physics.y+h>e.physics.y}};s.exports=t},function(s,e){},function(s,e,t){"use strict";t.r(e);var i=class{constructor(s,e,t=null,i=null){this.x=s,this.y=e,this.width=t,this.height=i,this.dLeft=0,this.dRight=0,this.dDown=0,this.dUp=0,this.dx=this.dx.bind(this),this.dy=this.dy.bind(this),this.speed=1}dx(){return-this.dLeft+this.dRight}dy(){return-this.dUp+this.dDown}updatePosition(){this.x+=this.dx(),this.y+=this.dy()}boundedUpdate(){const{dx:s,dy:e}=this;this.boundedMove({x:s(),y:e()},{top:0,down:580,left:80,right:350})}boundedMove(s,e){this.x+=s.x,this.y+=s.y,this.x<e.left&&(this.x=e.left),this.x>e.right&&(this.x=e.right),this.y<e.top&&(this.y=e.top),this.y>e.down&&(this.y=e.down)}};var h=class{constructor(s,e,t,i=1,h=1){this.img=s,this.height=e,this.width=t,this.width_scale=i,this.height_scale=h}};const o=new Image;o.src="./assets/images/road.png";var n=class{constructor(s){this.physics=s,this.sprite=new h(o,1262,502),this.score=0,this.gameOver=!1,this.box=null,this.marked=null}move(){this.physics.dDown=this.physics.speed}addScore(){this.gameOver?this.score:this.score+=1}makeGreen(){}stop(){this.physics.dDown=0,this.gameOver=!0}addSpeed(){}};const c=new Image,a=1.5,r=new Image;r.src="./assets/images/redbox.png";var l=class{constructor(s,e,t,i,o=-1){this.physics=s,c.src=e,this.sprite=new h(c,50,50,1*a,1*a),this.box=new h(r,40,50,1*a,1.3*a),this.marked=t,this.assetid=i,this.recognizedType=this.marked?"U":i[0],this.distance=o}updatesprite(s){c.src=s,this.sprite=new h(c,50,50,1*a,1*a)}move(){this.physics.dDown=this.physics.speed}stop(){this.physics.dDown=0}},d=t(0),g=t.n(d);const y=new Image,p=new Image,m=1.5;p.src="./assets/images/redbox.png";var f=class{constructor(s,e,t,i,o=-1){this.physics=s,y.src=e,this.sprite=new h(y,50,50,1*m,1*m),this.box=new h(p,40,50,1*m,1.3*m),this.marked=t,this.assetid=i,this.recognizedType=this.marked?"U":i[0],this.distance=o}updatesprite(s){y.src=s,this.sprite=new h(y,50,50,1*m,1*m)}move(){this.physics.dDown=this.physics.speed}stop(){this.physics.dDown=0}};const u=new Image,w=1.5,b=new Image;b.src="./assets/images/redbox.png";var v=class{constructor(s,e,t,i,o=-1){this.physics=s,u.src=e,this.sprite=new h(u,50,50,1*w,1*w),this.box=new h(b,40,50,1*w,1.3*w),this.marked=t,this.assetid=i,this.distance=o,this.recognizedType=this.marked?"U":i[0]}updatesprite(s){u.src=s,this.sprite=new h(u,50,50,1*w,1*w)}move(){this.physics.dDown=this.physics.speed}stop(){this.physics.dDown=0}};const x=new Image;x.src="./assets/images/car.png";var k=class{constructor(s){this.physics=s,this.sprite=new h(x,150,70),this.life=3,this.box=null,this.marked=null}hitObstacle(){this.life-=1}getLife(){this.life+=1}resetLife(){this.life=3}makeGreen(){}makeRed(){}draw(s){const{sprite:e,physics:t}=this,i=e.width/-2+t.width/2,h=e.height/-2+t.height/2;s.drawImage(e.img,0,0,e.width,e.height,t.x+i,t.y+h,e.width,e.height)}};var I=()=>({road:new n(new i(0,-561)),car:new k(new i(214,580,70,100))});const O="./assets/images/life/",L="./assets/images/obstacle/",T="./assets/images/money/";const E=80,_=150,C=350,M=.03,S=.01,R=115,D=Object.freeze({obstacle:"O",cash:"C",life:"L"}),A=.1,B=.4,z=3e3,U=3e4,P=1500;var j=null,Q=null,F=15;function G(s){for(var e=0,t=1;t<s.length;t++)s[t]<s[e]&&(e=t);return e}class q{constructor(s,e){this.canvas=s,this.ctx=e,this.gameOver=!1,this.rocks=[],this.life=[],this.cash=[],this.boxed=[],this.assets=I(),this.animate=null,this.lifeImgSrc="./assets/images/life/life (1).png",this.rockImgSrc="./assets/images/obstacle/obstacle (1).png",this.moneyImgSrc="./assets/images/money/money (1).png",this.lifeImgLists=[],this.moneyImgLists=[],this.obstacleImgLists=[],this.numImgs=16,this.assetidCounter=-1,this.activeResponse=!1,this.stopBlink=!1;var t=new Date;this.timeOfLastEnvQuery=t.getTime(),this.timeOfLastAttQuery=t.getTime();for(var i=0;i<this.numImgs;i++)this.lifeImgLists.push(O+"life ("+(i+1).toString()+").png"),this.moneyImgLists.push(T+"money ("+(i+1).toString()+").png"),this.obstacleImgLists.push(L+"obstacle ("+(i+1).toString()+").png");document.getElementById("obstacle").style["background-image"]="url('"+this.rockImgSrc+"')",document.getElementById("money").style["background-image"]="url('"+this.moneyImgSrc+"')",document.getElementById("life").style["background-image"]="url('"+this.lifeImgSrc+"')"}holdCanvas(s,e){var t=window.setInterval(function(){document.getElementById("canvas").style.border="20px solid "+e},5);setTimeout(function(s){document.getElementById("canvas").style.border="20px solid black",clearInterval(s)},s,t)}blinkCanvas(s,e,t){var i=window.setInterval(function(){document.getElementById("canvas").style.border!="20px solid "+t?document.getElementById("canvas").style.border="20px solid "+t:document.getElementById("canvas").style.border="20px solid black"},s);setTimeout(function(s){document.getElementById("canvas").style.border="20px solid black",clearInterval(s)},e,i)}askAttentionQueryBasedOnAttentionProbFunction(){var s=new Date;return Math.random()<1-Math.exp(-1*(s.getTime()-this.timeOfLastAttQuery)/P)}setRecognizedType(s,e){var t;switch(s[0]){case"O":for(t=0;t<this.rocks.length;t++)if(this.rocks[t].assetid==s){this.rocks[t].recognizedType=e;break}break;case"L":for(t=0;t<this.life.length;t++)if(this.life[t].assetid==s){this.life[t].recognizedType=e;break}break;case"C":for(t=0;t<this.cash.length;t++)if(this.cash[t].assetid==s){this.cash[t].recognizedType=e;break}break;default:console.log("Unrecognized asset type")}}checkUserResponse(s){this.boxed.length>0&&this.activeResponse&&(this.boxed[0][0]==s?(this.holdCanvas(2e3,"green"),this.activeResponse=!1,this.setRecognizedType(this.boxed[0],s)):(this.holdCanvas(2e3,"red"),this.activeResponse=!1,this.setRecognizedType(this.boxed[0],s)))}updateTimeBar(){var s=this.closestObject(),e=null,t=null;const i=this.assets.car.physics.y;this.assets.car.physics.height?this.assets.car.physics.height:(this.assets.car.sprite.height,this.assets.car.sprite.height_scale);var h,o=0;if(0==s?(t=this.cash[0].physics.height?this.cash[0].physics.height:this.cash[0].sprite.height*this.cash[0].sprite.height_scale,e=this.cash[0].physics.y,h=(new Date).getTime()):1==s?(t=this.rocks[0].physics.height?this.rocks[0].physics.height:this.rocks[0].sprite.height*this.rocks[0].sprite.height_scale,e=this.rocks[0].physics.y,h=(new Date).getTime()):2==s&&(t=this.life[0].physics.height?this.life[0].physics.height:this.life[0].sprite.height*this.life[0].sprite.height_scale,e=this.life[0].physics.y,h=(new Date).getTime()),null==j&&(o=null,j=h),null==Q&&(o=null,Q=e,j=h),null==e&&(o=null),null!=e&&null!=Q&&e<Q&&(o=null,Q=e,j=h),null!=o){new Date;F=i/(o=24);var n=(i-(e+t))/o;Q=e,j=h,document.getElementById("myBar").style.width=n/F*100+"%",document.getElementById("myBarTime").innerHTML=`${Math.floor(10*n)/10+"s"}`}}static checkCollision(s,e,t,i,h){e instanceof f&&g.a.collide_with_scale(s,e)&&(s.hitObstacle(),s.makeRed(),t.splice(t.indexOf(e),1),console.log("Before removing"),console.log(h),console.log(e.assetid),-1!=h.indexOf(e.assetid)&&h.splice(h.indexOf(e.assetid),1),console.log("After removing"),console.log(h),console.log(e.assetid)),e instanceof l&&g.a.collide_with_scale(s,e)&&(s.getLife(),s.makeGreen(),t.splice(t.indexOf(e),1),console.log("Before removing"),console.log(h),console.log(e.assetid),-1!=h.indexOf(e.assetid)&&h.splice(h.indexOf(e.assetid),1),console.log("After removing"),console.log(h),console.log(e.assetid)),e instanceof v&&g.a.collide_with_scale(s,e)&&(i.road.score+=100,i.road.makeGreen(),t.splice(t.indexOf(e),1),console.log("Before removing"),console.log(h),console.log(e.assetid),-1!=h.indexOf(e.assetid)&&h.splice(h.indexOf(e.assetid),1),console.log("After removing"),console.log(h),console.log(e.assetid))}obstacleProbablityFunction(){return Math.random()>.5}moneyProbablityFunction(){return Math.random()>.5}lifeProbablityFunction(){return Math.random()>.5}objectTypeProbablityFunction(){var s=Math.random();return s>0&&s<.33?D.obstacle:s>=.33&&s<.66?D.life:D.cash}boxDistanceProbablityFunction(){return A+Math.random()*(B-A)}static checkCanvas(s,e,t){s instanceof l&&s.physics.y>canvas.height&&(e.splice(e.indexOf(s),1),-1!=t.indexOf(s.assetid)&&t.splice(t.indexOf(s.assetid),1)),s instanceof f&&s.physics.y>canvas.height&&(e.splice(e.indexOf(s),1),-1!=t.indexOf(s.assetid)&&t.splice(t.indexOf(s.assetid),1)),s instanceof v&&s.physics.y>canvas.height&&(e.splice(e.indexOf(s),1),-1!=t.indexOf(s.assetid)&&t.splice(t.indexOf(s.assetid),1))}drawAsset(s){const{physics:e,sprite:t,box:i,marked:h,distance:o}=s;s instanceof n&&s.physics.y>=0&&t.height>canvas.height&&(s.physics.y>canvas.height&&(s.physics.y=canvas.height-t.height),this.ctx.drawImage(t.img,0,0,t.width,t.height,s.physics.x,s.physics.y-t.height+1,t.width,t.height)),s instanceof f&&s.physics.y>=0&&s.physics.y>canvas.height&&this.ctx.drawImage(t.img,0,0,t.width,t.height,s.physics.x,s.physics.y-900,t.width*t.width_scale,t.height*t.height_scale),s instanceof k?s.draw(this.ctx):(this.ctx.drawImage(t.img,0,0,t.width,t.height,e.x,e.y,t.width*t.width_scale,t.height*t.height_scale),h&&e.y>o*this.canvas.height&&(-1==this.boxed.indexOf(s.assetid)?0==this.boxed.length&&(this.boxed.push(s.assetid),this.blinkCanvas(30,300,"blue"),this.activeResponse=!0):this.ctx.drawImage(i.img,0,0,i.width,i.height,e.x+.5*(t.width*t.width_scale-i.width*i.width_scale),s.physics.y+.5*(t.height*t.height_scale-i.height*i.height_scale),i.width*i.width_scale,i.height*i.height_scale))),0!=this.assets.car.life&&(s instanceof k?e.boundedUpdate():e.updatePosition())}randomizesprite(){var s=Math.floor(Math.random()*Math.floor(this.numImgs)),e=Math.floor(Math.random()*Math.floor(this.numImgs)),t=Math.floor(Math.random()*Math.floor(this.numImgs));this.lifeImgSrc=this.lifeImgLists[s],this.moneyImgSrc=this.moneyImgLists[e],this.rockImgSrc=this.obstacleImgLists[t],document.getElementById("obstacle").style["background-image"]="url('"+this.rockImgSrc+"')",document.getElementById("money").style["background-image"]="url('"+this.moneyImgSrc+"')",document.getElementById("life").style["background-image"]="url('"+this.lifeImgSrc+"')"}draw(){if(!this.gameOver){const s=()=>{const e=Object.values(this.assets);this.animate=requestAnimationFrame(s),this.ctx.clearRect(0,0,canvas.width,canvas.height);for(let s=0;s<e.length;s++)this.drawAsset(e[s]);this.rocks.forEach(s=>{q.checkCollision(this.assets.car,s,this.rocks,this.assets,this.boxed),q.checkCanvas(s,this.rocks,this.boxed)}),this.life.forEach(s=>{q.checkCollision(this.assets.car,s,this.life,this.assets,this.boxed),q.checkCanvas(s,this.life,this.boxed)}),this.cash.forEach(s=>{q.checkCollision(this.assets.car,s,this.cash,this.assets,this.boxed),q.checkCanvas(s,this.cash,this.boxed)}),this.life.forEach(s=>{this.drawAsset(s),s.move()}),this.rocks.forEach(s=>{this.drawAsset(s),s.move()}),this.cash.forEach(s=>{this.drawAsset(s),s.move()}),this.assets.road.addScore(),this.end()};s()}}end(){0}createRock(s){this.rocks.push(new f(new i(Math.floor(310*Math.random())+80,-20),this.rockImgSrc,s,D.obstacle+(++this.assetidCounter).toString(),this.boxDistanceProbablityFunction()))}createLife(s){this.life.push(new l(new i(Math.floor(310*Math.random())+80,-20),this.lifeImgSrc,s,D.life+(++this.assetidCounter).toString(),this.boxDistanceProbablityFunction()))}createCash(s){this.cash.push(new v(new i(Math.floor(310*Math.random())+80,-20),this.moneyImgSrc,s,D.cash+(++this.assetidCounter).toString(),this.boxDistanceProbablityFunction()))}cleanUp(){window.cancelAnimationFrame(this.animate)}releaseControls(){this.assets.car.physics.dLeft=0,this.assets.car.physics.dRight=0,this.assets.car.physics.dUp=0,this.assets.car.physics.dDown=0}moveLeft(s){this.assets.car.physics.dLeft=s}moveRight(s){this.assets.car.physics.dRight=s}closestObject(){var s,e,t;s=this.cash&&this.cash.length>0?this.cash[0].physics.y:-1e4,e=this.rocks&&this.rocks.length>0?this.rocks[0].physics.y:-1e4,t=this.life&&this.life.length>0?this.life[0].physics.y:-1e4;var i=this.assets.car.physics.y,h=[1e4*(i-s<=-R)+(i-s)*(i-s>-R),1e4*(i-e<=-R)+(i-e)*(i-e>-R),1e4*(i-t<=-R)+(i-t)*(i-t>-R)],o=G(h);return h[o]>1e4&&(o=3),o}closestObjectAndLocation(){var s,e,t,i,h=0,o=3;this.cash&&this.cash.length>0?"U"!=this.cash[0].recognizedType&&(s=this.cash[0].physics.y,o="C"==this.cash[0].recognizedType?0:"O"==this.cash[0].recognizedType?1:2,h=this.cash[0].physics.x):s=-1e4,this.rocks&&this.rocks.length>0?"U"!=this.rocks[0].recognizedType&&(e=this.rocks[0].physics.y,o="O"==this.rocks[0].recognizedType?1:"C"==this.rocks[0].recognizedType?0:2,h=this.rocks[0].physics.x):e=-1e4,this.life&&this.life.length>0?"U"!=this.life[0].recognizedType&&(t=this.life[0].physics.y,o="L"==this.life[0].recognizedType?2:"C"==this.life[0].recognizedType?0:1,h=this.life[0].physics.x):t=-1e4;var n=this.assets.car.physics.y,c=[1e4*(n-s<=-R)+(n-s)*(n-s>-R),1e4*(n-e<=-R)+(n-e)*(n-e>-R),1e4*(n-t<=-R)+(n-t)*(n-t>-R)],a=G(c);return i=a,c[a]>1e4&&(a=3,h=0),[i,o,h]}rockAvoider(s){var e=this.assets.car.physics.x,t=e;Math.abs(s-e)>=E?(t=e,console.info("Decision: Not moving, obs diff x= ",s-e,"T_width=",E)):s>=e?e-_>=E-(s-e)?(t=s-E,console.info("Decision: Obs right, Going from left of obstacle ")):(t=s+E,console.info("Decision: Obs right, Going from right of obstacle ")):C-e>E-(e-s)?(t=s+E,console.info("Decision: Obs left, Going from right of obstacle ")):(t=s-E,console.info("Decision: Obs left, Going from left of obstacle "));var i=t-e;i>0?(this.moveRight(M*i),console.info("Controls: Right, ref = ",t,"err=",i)):i<0&&(this.moveLeft(-M*i),console.info("Controls: Left, ref = ",t,"err=",i))}objectGetter(s){var e=s-this.assets.car.physics.x;e>=0?this.moveRight(S*e):this.moveLeft(-S*e)}moveRandom(s){Math.random()>=.5?(console.info("Controls: ","Random Left"),this.moveLeft(s)):(console.info("Controls: ","Random Right"),this.moveRight(s))}start(){this.gameOver=!1,document.getElementById("welcome").style.display="none",this.assets.car.resetLife(),setInterval(()=>{if(!this.gameOver){var s=new Date,e=Array.isArray(this.boxed)&&!this.boxed.length,t=e&&s.getTime()-this.timeOfLastEnvQuery>U;t&&(console.log("Asking Environment Query: "+(s.getTime()-this.timeOfLastEnvQuery).toString()),this.timeOfLastEnvQuery=s.getTime());var i=e&&!t&&this.askAttentionQueryBasedOnAttentionProbFunction()&&s.getTime()-this.timeOfLastEnvQuery>z&&this.timeOfLastEnvQuery+U-s.getTime()>z;switch(i&&(console.log("Asking Attention Query:"+(s.getTime()-this.timeOfLastAttQuery).toString()),this.timeOfLastAttQuery=s.getTime()),this.objectTypeProbablityFunction()){case D.obstacle:this.createRock(t||i);break;case D.life:this.createLife(t||i);break;case D.cash:this.createCash(t||i)}0}},12e3),setInterval(()=>{this.randomizesprite()},84e3),setInterval(()=>{this.updateTimeBar()},50),setInterval(()=>{var s;this.releaseControls(),1==(s=this.closestObjectAndLocation())[1]?this.rockAvoider(s[2]):0!=s[1]&&2!=s[1]||this.objectGetter(s[2])},1e3),this.draw(),this.assets.road.move()}}var H=q;var W=s=>{window.addEventListener("keydown",e=>{s.assets.car,"q"!==e.key&&"Q"!==e.key||s.checkUserResponse("O"),"w"!==e.key&&"W"!==e.key||s.checkUserResponse("C"),"e"!==e.key&&"E"!==e.key||s.checkUserResponse("L")}),window.addEventListener("keyup",e=>{s.assets.car})};(new Image).src="./assets/images/redbox.png";window.lifeimgLst="",window.obstacleimgLst="",window.moneyImgLst="";t(1);document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("canvas"),e=s.getContext("2d");s.height=700,s.width=500;let t=new H(s,e);document.getElementById("how").innerHTML="v1 - Use directional arrows or WSAD to move your car around. Collect as much cash as you can to increase your points while avoiding the rocks!",document.getElementById("play-btn").addEventListener("click",()=>{!0===t.gameOver&&(t.cleanUp(),t=new H(s,e)),W(t),t.start()})})}]);